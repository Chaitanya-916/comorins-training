<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <title>Res</title>
</head>
<body class="container-fluid">
    <label>Name:</label>
    <input type="text" onkeyup="addDetail('name',this.value)" /><br/>
    <label>Role:</label>
    <input type="text" onkeyup="addDetail('Role',this.value)"/><br/>
    <label>Email:</label>
    <input type="email" onkeyup="addDetail('Email',this.value)" /><br/>
    <label>Mobile-no:</label>
    <input type="number" onkeyup="addDetail('Mobile',this.value)"/><br/>
    <label>Summary:</label>
    <textarea type="text" onkeyup="addDetail('Summary',this.value)"></textarea><br/>
    <label>Experiance:</label><br>
    <label>Role:</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,0,'role')"/>
    <label>Company Name:</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,0,'Company name:')"/>
    <label>place:</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,0,'Place',)"/>
    <label>Date of start:</label>
    <input type="date" onkeyup="addDetail('experiance',this.value,0,'Date of start')"/>
    <label>Date of releave:</label>
    <input type="date" onkeyup="addDetail('experiance',this.value,0,'Date of releave')"/><br/>
    <br/>
    <label>Role:</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,1,'role')"/>
    <label>Company Name</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,1,'Company name:')"/>
    <label>place</label>
    <input type="text" onkeyup="addDetail('experiance',this.value,1,'Place',)"/>
    <label>Date of start</label>
    <input type="date" onkeyup="addDetail('experiance',this.value,1,'Date of start')"/>
    <label>Date of releave</label>
    <input type="date" onkeyup="addDetail('experiance',this.value,1,'Date of releave')"/><br/>
    <label>Area of intrest</label>
    <input type="text" onkeyup="addDetail('area of intrest',this.value)"/><br/>
    <label>Skills:</label>
    <input type="text" onkeyup="addDetail('skills',this.value,0)" />
    <input type="text" onkeyup="addDetail('skills',this.value,1)" />
    <input type="text" onkeyup="addDetail('skills',this.value,2)" /><br/>
    <table>
        <br/>
        <h4>Education:</h4>
        <thead>
            <th>Cource</th>
            <th>year</th>
            <th>Institute</th>
            <th>Percentage</th>
        </thead>
        <tr>
            <td><input type="text" onkeyup="addDetail('education',this.value,0,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,0,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,0,'institute')" /></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,0,'percentage')"/></td>
        </tr>
        <tr>
            <td><input type="text" onkeyup="addDetail('education',this.value,1,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,1,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,1,'institute')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,1,'percentage')"/></td>
        </tr>
        <tr>
            <td><input type="text" onkeyup="addDetail('education',this.value,2,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,2,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,2,'institute')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,2,'percentage')"/></td>
        </tr>
        <tr>
            <td><input type="text" onkeyup="addDetail('education',this.value,3,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,3,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,3,'institute')"/></td>
            <td><input type="text" onkeyup="addDetail('education',this.value,3,'percentage')"/></td>
        </tr>
    </table>
    <br/>
    <table>
        <tr>
        <h4>Projects:</h4>
        <thead>
            <th>Title</th>
            <th>Abstract</th>
            <th>Software Used</th>
        </thead>
        <td><input type="text" onkeyup="addDetail('projects',this.value,0,'title')"/></td>
        <td><textarea type="text" onkeyup="addDetail('projects',this.value,0,'abstract')"></textarea></td>
        <td><input type="text" onkeyup="addDetail('projects',this.value,0,'software_used')"/></td>
        </tr>
        <br/>
        <tr>
        <td><input type="text" onkeyup="addDetail('projects',this.value,1,'title')"/></td>
        <td><textarea type="text" onkeyup="addDetail('projects',this.value,1,'abstract')"></textarea></td>
        <td><input type="text" onkeyup="addDetail('projects',this.value,1,'software_used')"/></td>
        </tr>
    </table>
    <table>
        <br/>
        <h4>certification:</h4>
        <thead>
            <th>Cource</th>
            <th>Year</th>
            <th>Institution</th>
        </thead>
        <tr>
            <td><input type="text" onkeyup="addDetail('certification',this.value,0,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('certification',this.value,0,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('certification',this.value,0,'institute')" /></td>
        </tr>
        <tr>
            <td><input type="text" onkeyup="addDetail('certification',this.value,1,'course')"/></td>
            <td><input type="text" onkeyup="addDetail('certification',this.value,1,'year')"/></td>
            <td><input type="text" onkeyup="addDetail('certification',this.value,1,'institute')"/></td>
        </tr>
    </table>
    <br/>
    <h4>Personal Details: </h4><br/>
    <label>Age:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'age')" /><br/>
    <label>DOB:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'dob')" /><br/>
    <label>Gender:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'gender')" /><br/>
    <label>marital status:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'marital-status')" /><br/>
    <br/>
    <label>Address:</label><br/>
    <br/>
    <label>House-no:</label>
    <input type="number" onkeyup="addDetail('personal_details',this.value,'address','house-no')" /><br/>
    <label>Street-Name:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'address','street-name')" /><br/>
    <label>Town:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'address','town')" /><br/>
    <label>District:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'address','district')" /><br/>
    <label>State:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'address','state')" /><br/>
    <label>country:</label>
    <input type="text" onkeyup="addDetail('personal_details',this.value,'address','country')" /><br/>
    <label>Pin-Code:</label>
    <input type="number" onkeyup="addDetail('personal_details',this.value,'address','pin-code')" /><br/>
    <label>Languages Known:</label>
    <br/>
    <input type="text" id="languages" onkeyup="addDetail('personal_details',this.value,'languages_known',0)"/><br/>
    <input type="text" id="languages" onkeyup="addDetail('personal_details',this.value,1,'languages_known')" /><br/>
    <input type="text" id="languages" onkeyup="addDetail('personal_details',this.value,2,'languages_known')" /><br/>
    <button id="sub-button">Submit</button>
    <div>
        <code id="objective"></code>
        
    </div>
    <table class="table">
        <thead>
          <tr>
            <th scope="col">S.No</th>
            <th scope="col">Name</th>
            <th scope="col">Skill</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody id="show">
        </tbody>
    </table>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script type="text/javascript">
         let my_resume={
            skills:[],
            education:[],
            experiance:[],
            projects:[],
            certification:[],
            personal_details:{},
         };
        function addDetail(key,value,index=null,key_1=null,key_2=null){
            if(index==null && key_1==null){
                my_resume[key]=value;
            }
            
            else if(key_1!=null) {
                if(!my_resume[key][index]){
                    my_resume[key][index]={};
                }
                my_resume[key][index][key_1]=value;
            } 
            else{
                my_resume[key][index]=value;
            }
        }        
        $(document).ready(function(){
            function get_user(){
                $.ajax({
                    url:"http://karka.academy/api/action.php",
                    type:"get",
                    data:{
                        request:"get_user_resume",
                        user:"chaitanya",
                    },
                    success:function(data){
                        let inner_data=JSON.parse(data).data;    
                            console.log(inner_data);
                         for(let i=0;i<inner_data.length;i++){ 
                            let data2=JSON.parse(inner_data[i].data);   
                            $("#show").append('<tr>' + 
                                '<th scope="row">'+(i+1)+'</th>'+
                                '<td><a href=view.html?id='+inner_data[i].id+'>'+data2.name+'</a></td>' +
                                '<td>'+data2.skills[0]+'</td>'+
                                '<td> <button id="remove" value='+inner_data[i].id+'> Remove</button> </td>' +
                            '</tr>');                         
                        }
                    },
                });
            }
            $.ajax({
                    url:"http://karka.academy/api/action.php",
                    type:"get",
                    data:{
                        request:"get_user_resume",
                        user:"chaitanya",
                    },
                    success:function(data){
                        get_user();
                    },
                });
            $("#sub-button").click(function(){  
                $.ajax({
                    url:"http://karka.academy/api/action.php",
                    type:"post",
                    data:{
                        request:"create_resume",
                        user:"chaitanya",
                        resume:my_resume,
                    },
                    success:function(data){
                        $("#show").html("");
                        console.log(data)
                        get_user();                                         
                    }
                });
            });
            $(document).on("click","#remove",function(){
            let delete_id=$(this).val();
            $.ajax({
                    url:"http://karka.academy/api/action.php",
                    type:"get",
                    data:{
                        request:"delete_user_resume",
                        user:"chaitanya",
                        id:delete_id,
                    },
                    success:function(data){
                        $("#show").html("");
                        get_user();
                    }
           });
           });
        });
           
        
    </script> 
</body>
</html> 